# ====================================
# dev 프로필 - k3d 개발환경 (Kubernetes)
# ====================================

spring:
  datasource:
    master:
      url: jdbc:postgresql://product-db:5433/product_db
      username:
      password:
      driver-class-name: org.postgresql.Driver
    replica:
      url: jdbc:postgresql://product-db:5433/product_db
      username:
      password:
      driver-class-name: org.postgresql.Driver
      hikari:
        maximum-pool-size: 5
  data:
    redis:
      host: cache-redis
      port: 6379
  jpa:
    hibernate:
      ddl-auto: none
      naming:
        implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
        physical-strategy: org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
    properties:
      hibernate:
        format_sql: true  # SQL 포맷팅 활성화 (개발 환경)
        dialect: org.hibernate.dialect.PostgreSQLDialect
    show-sql: false
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:kafka:9092}

# ====================================
# dev 환경 로그 레벨 (k3d 개발 환경)
# ====================================
logging:
  level:
    root: INFO

    # 프로젝트 패키지 - DEBUG 레벨 (상세 개발 로그)
    com.groom.product: DEBUG

    # Spring Framework
    org.springframework: INFO
    org.springframework.web: DEBUG
    org.springframework.security: DEBUG

    # Hibernate/JPA - SQL 쿼리 디버깅
    org.hibernate: INFO
    org.hibernate.SQL: DEBUG
    org.hibernate.orm.jdbc.bind: TRACE

  file:
    path: ./logs

# Redis 설정 (ExternalName 서비스 사용)
spring.data.redis:
  host: ${REDIS_HOST:cache-redis}
  port: ${REDIS_PORT:6379}

# Platform Core Saga Tracker 설정
platform:
  saga:
    enabled: true

# Security 설정
security:
  jwt:
    secret: ${JWT_SECRET:dev-environment-secret-please-change}
    issuer: ecommerce-service-api
    accessTokenExpirationMinutes: 60
    refreshTokenExpirationDays: 7

# Feign Client 설정 (k3d 서비스 이름 사용)
feign:
  clients:
    store-service:
      url: ${STORE_SERVICE_URL:http://store-api}
      connect-timeout: 5000
      read-timeout: 5000
      logger-level: full
  client:
    config:
      store-service:
        connectTimeout: 5000
        readTimeout: 5000
        loggerLevel: full

# Kafka Topic 설정
kafka:
  topics:
    product-registered: product.registered
    product-deleted: product.deleted

# AWS S3 설정 (k3d)
# AWS 자격증명은 Kubernetes Secret을 통해 환경변수로 주입됩니다.
# - AWS_ACCESS_KEY_ID
# - AWS_SECRET_ACCESS_KEY
aws:
  s3:
    enabled: ${AWS_S3_ENABLED:true}
    bucket-name: ${AWS_S3_BUCKET:c4ang-product-images-dev}
    region: ${AWS_REGION:ap-northeast-2}

# Gemini AI 설정 (k3d)
gemini:
  api-key: ${GEMINI_API_KEY:}
  model: gemini-pro
  max-tokens: 2000
