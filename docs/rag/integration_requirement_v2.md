# C4ang μ±—λ΄‡ - κΈ°λ¥λ³„ μ—°λ™ μ”κµ¬μ‚¬ν•­ (v2)

> **λ©μ **: μ±—λ΄‡μ΄ Internal APIμ™€ μ—°λ™ν•  λ• ν•„μ”ν• λ°μ΄ν„° μ •λ³΄λ¥Ό μ •λ¦¬ν•©λ‹λ‹¤.
> **λ³€κ²½μ‚¬ν•­ (v2)**:
> - μ©λ‰ μ •λ³΄λ” ν–¥μ μƒμ„Έμ •λ³΄μ— ν¬ν•¨ (μ©λ‰λ³„ λ³„λ„ μ ν’ X)
> - `top_k`, `similarity_score` λ“± μ μ‚¬λ„ κ΄€λ ¨ νλΌλ―Έν„° μ κ±° (RAGμ—μ„ λ²΅ν„°DBλ΅ μ²λ¦¬)
> - Product μ„λΉ„μ¤λ” μ΅°κ±΄μ— λ§λ” μ ν’ μ •λ³΄λ§ μ κ³µ

---

## π― κΈ°λ¥ 1: ν–¥μ κ²€μƒ‰

### π“ μ©λ„
μ΅°κ±΄μ— λ§λ” ν–¥μ λ©λ΅μ„ κ²€μƒ‰ν•©λ‹λ‹¤. μ μ‚¬λ„ κΈ°λ° μ¶”μ²μ€ RAG μ„λΉ„μ¤μ—μ„ λ²΅ν„°DBλ¥Ό ν†µν•΄ μ²λ¦¬ν•©λ‹λ‹¤.

### π’¬ μ‚¬μ© μμ‹
- "ν”λ΅λ„ ν–¥μ μ°Ύμ•„μ¤"
- "μ—¬λ¦„μ— μ–΄μΈλ¦¬λ” μƒνΌν• ν–¥μ"
- "λ””μ¬ ν–¥μ λ©λ΅"

### π“¥ μ±—λ΄‡μ΄ λ³΄λ‚Ό μ μλ” μ…λ ¥ (Input)

| νλΌλ―Έν„° | νƒ€μ… | ν•„μ | μ„¤λ… | μμ‹ κ°’ |
|---------|------|------|------|--------|
| `query` | string | β | κ²€μƒ‰ μΏΌλ¦¬ (ν‚¤μ›λ“) | `"ν”λ΅λ„"` |
| `scent_family` | string | β | ν–¥μ΅° ν•„ν„° | `ν”λ΅λ„`, `μ°λ””`, `μ‹νΈλ¬μ¤` λ“± |
| `season` | string | β | κ³„μ  | `λ΄„`, `μ—¬λ¦„`, `κ°€μ„`, `κ²¨μΈ` |
| `brand` | string | β | λΈλλ“ | `λ””μ¬`, `μƒ¤λ„¬`, `μ΅°λ§λ΅ ` λ“± |
| `gender` | string | β | μ„±λ³„ | `λ‚¨μ„±`, `μ—¬μ„±`, `μ λ‹μ„Ήμ¤` |
| `price_min` | number | β | μµμ† κ°€κ²© | `50000` |
| `price_max` | number | β | μµλ€ κ°€κ²© | `200000` |
| `product_ids` | array[string] | β | νΉμ • ID λ©λ΅ μ΅°ν | `["uuid-1", "uuid-2"]` |

> **μ°Έκ³ **: `product_ids`κ°€ μ κ³µλλ©΄ λ‹¤λ¥Έ ν•„ν„°λ” λ¬΄μ‹ν•κ³  ν•΄λ‹Ή IDμ μ ν’λ§ λ°ν™ν•©λ‹λ‹¤.
> RAGμ—μ„ λ²΅ν„°DBλ΅ μ μ‚¬ ν–¥μ IDλ¥Ό μ°Ύμ€ ν›„, μ΄ νλΌλ―Έν„°λ΅ μƒμ„Έ μ •λ³΄λ¥Ό μ΅°νν•©λ‹λ‹¤.

### π“¤ μ±—λ΄‡μ΄ ν•„μ”ν• μ¶λ ¥ (Output)

```json
{
  "results": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "brand": "μ΅°λ§λ΅ ",
      "name": "λΌμ„ λ°”μ§ μ•¤ λ§λ‹¤λ¦°",
      "concentration": "EDC",
      "main_accords": ["μ‹νΈλ¬μ¤", "μ•„λ΅λ§ν‹±"],
      "description": "μƒμΎν• μ‹νΈλ¬μ¤ ν–¥μ΄ νΉμ§•μΈ μ—¬λ¦„ ν–¥μ",
      "gender": "Unisex",
      "image_url": "https://...",
      "sizes": [
        { "size_ml": 30, "price": 95000 },
        { "size_ml": 100, "price": 195000 }
      ]
    }
  ],
  "total_count": 1
}
```

---

## π― κΈ°λ¥ 2: ν–¥μ μƒμ„Έ μ΅°ν

### π“ μ©λ„
νΉμ • ν–¥μμ μƒμ„Έ μ •λ³΄(λ…ΈνΈ, μ„¤λ…, μ©λ‰λ³„ κ°€κ²© λ“±)λ¥Ό μ΅°νν•©λ‹λ‹¤.

### π“¥ μ±—λ΄‡μ΄ λ³΄λ‚Ό μ μλ” μ…λ ¥ (Input)

| νλΌλ―Έν„° | νƒ€μ… | ν•„μ | μ„¤λ… | μμ‹ κ°’ |
|---------|------|------|------|--------|
| `product_id` | string | β… | ν–¥μ κ³ μ  ID (UUID) | `"550e8400-e29b-41d4-a716-446655440000"` |

### π“¤ μ±—λ΄‡μ΄ ν•„μ”ν• μ¶λ ¥ (Output)

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "brand": "λ””μ¬",
  "name": "λ―Έμ¤ λ””μ¬",
  "concentration": "EDP",
  "main_accords": ["ν”λ΅λ„", "λ΅μ¦"],
  "top_notes": ["λ§λ‹¤λ¦°", "λ² λ¥΄κ°€λ»"],
  "middle_notes": ["λ΅μ¦", "ν”Όμ¤λ‹"],
  "base_notes": ["λ¨Έμ¤ν¬", "μƒλ‹¬μ°λ“"],
  "description": "μ°μ•„ν• ν”λ΅λ„ ν–¥μλ΅ λ΅λ§¨ν‹±ν• λ¶„μ„κΈ°λ¥Ό μ—°μ¶ν•©λ‹λ‹¤.",
  "gender": "Female",
  "season_score": {
    "spring": 35.0,
    "summer": 10.0,
    "fall": 40.0,
    "winter": 15.0
  },
  "day_night_score": {
    "day": 70.0,
    "night": 30.0
  },
  "sizes": [
    { "size_ml": 30, "price": 120000 },
    { "size_ml": 50, "price": 180000 },
    { "size_ml": 100, "price": 280000 }
  ],
  "image_url": "https://...",
  "detail_url": "https://..."
}
```

---

## π― κΈ°λ¥ 3: ν–¥μ λΉ„κµ

### π“ μ©λ„
2~4κ°μ ν–¥μλ¥Ό λΉ„κµ λ¶„μ„ν•©λ‹λ‹¤.

### π“¥ μ±—λ΄‡μ΄ λ³΄λ‚Ό μ μλ” μ…λ ¥ (Input)

| νλΌλ―Έν„° | νƒ€μ… | ν•„μ | μ„¤λ… | μμ‹ κ°’ |
|---------|------|------|------|--------|
| `product_ids` | array[string] | β… | λΉ„κµν•  ν–¥μ ID λ©λ΅ (2~4κ°) | `["uuid-1", "uuid-2"]` |

### π“¤ μ±—λ΄‡μ΄ ν•„μ”ν• μ¶λ ¥ (Output)

```json
{
  "comparison_count": 2,
  "products": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "brand": "λ””μ¬",
      "name": "λ―Έμ¤ λ””μ¬",
      "concentration": "EDP",
      "main_accords": ["ν”λ΅λ„", "λ΅μ¦"],
      "top_notes": ["λ§λ‹¤λ¦°"],
      "middle_notes": ["λ΅μ¦"],
      "base_notes": ["λ¨Έμ¤ν¬"],
      "gender": "Female",
      "sizes": [
        { "size_ml": 30, "price": 120000 },
        { "size_ml": 50, "price": 180000 }
      ]
    },
    {
      "id": "550e8400-e29b-41d4-a716-446655440001",
      "brand": "μƒ¤λ„¬",
      "name": "μ½”μ½” λ§λ“λ¨μ•„μ ¤",
      "concentration": "EDP",
      "main_accords": ["ν”λ΅λ„", "μ‹νΈλ¬μ¤"],
      "top_notes": ["μ¤λ μ§€"],
      "middle_notes": ["μ¬μ¤λ―Ό"],
      "base_notes": ["λ°”λ‹λΌ"],
      "gender": "Female",
      "sizes": [
        { "size_ml": 50, "price": 200000 },
        { "size_ml": 100, "price": 320000 }
      ]
    }
  ]
}
```

---

## π“ ν•„μ”ν• ν–¥μ λ°μ΄ν„° ν•„λ“ μ •λ¦¬

| ν•„λ“λ… | νƒ€μ… | ν•„μ | μ„¤λ… | μ‚¬μ©ν•λ” κΈ°λ¥ |
|--------|------|------|------|--------------|
| `id` | string (UUID) | β… | ν–¥μ κ³ μ  ID | μ „μ²΄ |
| `brand` | string | β… | λΈλλ“λ… | μ „μ²΄ |
| `name` | string | β… | ν–¥μλ… | μ „μ²΄ |
| `concentration` | string | β­• | λ†λ„ (Parfum/EDP/EDT/EDC) | μ „μ²΄ |
| `main_accords` | array[string] | β­• | μ£Όμ” ν–¥μ΅° | μ „μ²΄ |
| `top_notes` | array[string] | β­• | νƒ‘λ…ΈνΈ | μƒμ„Έ, λΉ„κµ |
| `middle_notes` | array[string] | β­• | λ―Έλ“¤λ…ΈνΈ | μƒμ„Έ, λΉ„κµ |
| `base_notes` | array[string] | β­• | λ² μ΄μ¤λ…ΈνΈ | μƒμ„Έ, λΉ„κµ |
| `description` | string | β | ν–¥μ μ„¤λ… | κ²€μƒ‰, μƒμ„Έ |
| `gender` | string | β­• | μ„±λ³„ νƒ€κ² | μ „μ²΄ |
| `sizes` | array[object] | β­• | μ©λ‰λ³„ κ°€κ²© μ •λ³΄ | μ „μ²΄ |
| `sizes[].size_ml` | number | β… | μ©λ‰ (ml) | - |
| `sizes[].price` | number | β… | κ°€κ²© | - |
| `season_score` | object | β | κ³„μ  μ μ | μƒμ„Έ |
| `day_night_score` | object | β | μ£Όμ•Όκ°„ μ μ | μƒμ„Έ |
| `image_url` | string | β | μ΄λ―Έμ§€ URL | κ²€μƒ‰, μƒμ„Έ |
| `detail_url` | string | β | μƒμ„Έ νμ΄μ§€ URL | μƒμ„Έ |

> β… ν•„μ / β­• κ¶μ¥ / β μ„ νƒ

---

## π” ν•„ν„° μµμ… μ •λ¦¬

### ν–¥μ΅° (scent_family)
- `ν”λ΅λ„`, `μ°λ””`, `μ‹νΈλ¬μ¤`, `μ¤λ¦¬μ—”νƒ`, `ν”„λ μ‹`, `μ¤νμ΄μ‹`, `μ•„λ΅λ§ν‹±`, `λ¨Έμ¤ν¬`, `νμ°λ”λ¦¬`

### κ³„μ  (season)
- `λ΄„`, `μ—¬λ¦„`, `κ°€μ„`, `κ²¨μΈ`

### μ„±λ³„ (gender)
- `λ‚¨μ„±`, `μ—¬μ„±`, `μ λ‹μ„Ήμ¤`

### λ†λ„ (concentration)
- `Parfum` (κ°€μ¥ μ§„ν•¨)
- `EDP` (Eau de Parfum)
- `EDT` (Eau de Toilette)
- `EDC` (Eau de Cologne)

---

## π”„ v1 λ€λΉ„ λ³€κ²½μ‚¬ν•­

| ν•­λ© | v1 | v2 |
|------|----|----|
| μ©λ‰ μ²λ¦¬ | λ‹¨μΌ κ°€κ²© | `sizes` λ°°μ—΄λ΅ μ©λ‰λ³„ κ°€κ²© μ κ³µ |
| μ μ‚¬λ„ κ²€μƒ‰ | `top_k`, `similarity_score` ν¬ν•¨ | μ κ±° (RAG λ²΅ν„°DBμ—μ„ μ²λ¦¬) |
| ID ν•μ‹ | λ―Έμ • | UUID |
| λ…ΈνΈ λ°μ΄ν„° νƒ€μ… | string | array[string] |
| κΈ°λ¥ 3 (μ μ‚¬ ν–¥μ) | λ³„λ„ API | κ²€μƒ‰ APIμ `product_ids` νλΌλ―Έν„°λ΅ ν†µν•© |

---

## π“ μ—°λ½μ²

μ΄ λ¬Έμ„λ¥Ό κΈ°λ°μΌλ΅ Internal API λ…μ„Έλ¥Ό κ³µμ ν•΄μ£Όμ‹λ©΄ μ—°λ™ μ‘μ—…μ„ μ§„ν–‰ν•κ² μµλ‹λ‹¤!
